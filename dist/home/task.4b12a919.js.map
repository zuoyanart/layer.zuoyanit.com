{"version":3,"sources":["pages/usercenter/task/form/buyTask.vue","pages/usercenter/task/task.vue"],"names":[],"mappings":";AAoBA,aAAA,SAAA,mBAAA,IAAA,QAAA,OAAA,MAAA,OAAA,IAAA,KAAA,IAAA,IAAA,KAAA,IAAA,KAAA,KAAA,IAAA,MAAA,KAAA,MAAA,MAAA,OAAA,YAAA,OAAA,OAAA,KAAA,KAAA,QAAA,OAAA,QAAA,QAAA,OAAA,KAAA,MAAA,QAAA,SAAA,kBAAA,IAAA,OAAA,WAAA,IAAA,KAAA,KAAA,KAAA,UAAA,OAAA,IAAA,QAAA,SAAA,QAAA,QAAA,IAAA,IAAA,GAAA,MAAA,KAAA,MAAA,SAAA,MAAA,OAAA,mBAAA,IAAA,QAAA,OAAA,MAAA,OAAA,OAAA,OAAA,SAAA,OAAA,KAAA,mBAAA,IAAA,QAAA,OAAA,MAAA,OAAA,QAAA,KAAA,WAAA,MAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,aAAA,EAAA,IAAA,SAAA,CACA,KAAA,WACA,MAAA,CACA,KAAA,CACA,QAAA,KAIA,MAAA,CACA,SAAA,CACA,KAAA,OACA,QAAA,WACA,MAAA,KAGA,QAAA,GACA,MAAA,CACA,KAAA,OACA,SAAA,IAGA,QAAA,CACA,gBAAA,WACA,IAAA,KAAA,GACA,IAAA,IAAA,EAAA,EAAA,EAAA,GAAA,IACA,KAAA,KAAA,CACA,MAAA,EAAA,KACA,MAAA,IAGA,OAAA,MAEA,IAXA,WAAA,IAAA,KAAA,kBAAA,mBAAA,KAAA,SAAA,UAAA,IAAA,IAAA,OAAA,mBAAA,KAAA,SAAA,UAAA,OAAA,OAAA,SAAA,KAAA,SAAA,MAAA,KAAA,EAYA,OAZA,SAAA,KAAA,EAYA,KAAA,OAAA,UAAA,YAAA,OAAA,CACA,OAAA,KAAA,SAAA,GACA,QAAA,KAAA,KAAA,UAdA,KAAA,EAgBA,OAJA,IAZA,SAAA,MAgBA,OACA,KAAA,QAAA,MAAA,aAAA,CACA,MAAA,KAAA,MACA,IAAA,cACA,MAAA,IAAA,OAEA,KAAA,OAAA,MAAA,KAAA,UAtBA,KAAA,EAAA,IAAA,MAAA,OAAA,SAAA,SAAA,QAAA,SAAA,OAAA,WAAA,OAAA,KAAA,MAAA,KAAA,YAAA,KArBA,QAAA,QAAA;;;ACuDA,aAAA,OAAA,eAAA,QAAA,aAAA,CAAA,OAAA,IAAA,QAAA,aAAA,EAHA,IAAA,OAAA,uBAAA,QAAA,sBACA,IAAA,UAAA,uBAAA,QAAA,mBAEA,SAAA,uBAAA,KAAA,OAAA,KAAA,IAAA,WAAA,IAAA,CAAA,QAAA,KAAA,SAAA,mBAAA,IAAA,QAAA,OAAA,MAAA,OAAA,IAAA,KAAA,IAAA,IAAA,KAAA,IAAA,KAAA,KAAA,IAAA,MAAA,KAAA,MAAA,MAAA,OAAA,YAAA,OAAA,OAAA,KAAA,KAAA,QAAA,OAAA,QAAA,QAAA,OAAA,KAAA,MAAA,QAAA,SAAA,kBAAA,IAAA,OAAA,WAAA,IAAA,KAAA,KAAA,KAAA,UAAA,OAAA,IAAA,QAAA,SAAA,QAAA,QAAA,IAAA,IAAA,GAAA,MAAA,KAAA,MAAA,SAAA,MAAA,OAAA,mBAAA,IAAA,QAAA,OAAA,MAAA,OAAA,OAAA,OAAA,SAAA,OAAA,KAAA,mBAAA,IAAA,QAAA,OAAA,MAAA,OAAA,QAAA,KAAA,WAAA,MAAA,IAAA,SAAA,CACA,OAAA,CAAA,OAAA,SACA,KAAA,WACA,MAAA,CACA,MAAA,SAGA,QAPA,WAAA,IAAA,SAAA,kBAAA,mBAAA,KAAA,SAAA,UAAA,IAAA,MAAA,KAAA,OAAA,mBAAA,KAAA,SAAA,UAAA,OAAA,OAAA,SAAA,KAAA,SAAA,MAAA,KAAA,EAQA,KAAA,IAAA,aAAA,SAAA,MACA,MAAA,KAAA,MAAA,UAAA,KAAA,OAAA,KAAA,IAAA,KAAA,SATA,KAAA,EAAA,IAAA,MAAA,OAAA,SAAA,SAAA,QAAA,SAAA,OAAA,WAAA,OAAA,SAAA,MAAA,KAAA,YAAA,GAYA,QAAA,CACA,OAAA,WACA,KAAA,UAAA,QAAA,KAAA,OAAA,OAAA,SAEA,QAAA,WACA,MAAA,8BAAA,KAAA,OAAA,OAAA,QAAA,SAEA,SAPA,WAAA,IAAA,UAAA,kBAOA,mBAAA,KAAA,SAAA,SAAA,KAPA,OAAA,mBAAA,KAAA,SAAA,WAAA,OAAA,OAAA,UAAA,KAAA,UAAA,MAAA,KAAA,EAQA,OARA,UAAA,KAAA,EAQA,KAAA,OAAA,UAAA,aAAA,MAAA,CACA,GAAA,IAAA,KATA,KAAA,EAWA,MAXA,UAAA,KAWA,OACA,IAAA,SAAA,EACA,KAAA,OAAA,IAAA,SAbA,KAAA,EAAA,IAAA,MAAA,OAAA,UAAA,SAAA,SAAA,SAAA,OAAA,SAAA,IAAA,OAAA,UAAA,MAAA,KAAA,YAAA,GAgBA,UAhBA,WAAA,IAAA,WAAA,kBAgBA,mBAAA,KAAA,SAAA,SAAA,KAhBA,OAAA,mBAAA,KAAA,SAAA,WAAA,OAAA,OAAA,UAAA,KAAA,UAAA,MAAA,KAAA,EAiBA,OAjBA,UAAA,KAAA,EAiBA,KAAA,OAAA,UAAA,cAAA,MAAA,CACA,GAAA,IAAA,KAlBA,KAAA,EAoBA,MApBA,UAAA,KAoBA,OACA,IAAA,SAAA,EACA,KAAA,OAAA,IAAA,SAtBA,KAAA,EAAA,IAAA,MAAA,OAAA,UAAA,SAAA,SAAA,SAAA,OAAA,SAAA,KAAA,OAAA,WAAA,MAAA,KAAA,YAAA,GAyBA,QAAA,WAAA,IAAA,IAAA,UAAA,OAAA,QAAA,IAAA,UAAA,GAAA,UAAA,GAAA,GAAA,IAAA,MAAA,UAAA,OAAA,EAAA,UAAA,QAAA,EACA,KAAA,OAAA,OAAA,CACA,MAAA,GACA,QAAA,CACA,QAAA,UADA,QAEA,OAAA,KACA,KAAA,CACA,SAAA,IACA,MAAA,QAGA,KAAA,CAAA,QAAA,YAGA,cAAA,SAAA,KAAA,KACA,MAAA,CACA,KAAA,KACA,IAAA,IACA,MAJA,UAAA,OAAA,QAAA,IAAA,UAAA,GAAA,UAAA,IAAA,IAOA,cAAA,SAAA,SACA,OAAA,QAAA,MACA,IAAA,MACA,KAAA,IAAA,QAAA,KACA,MACA,IAAA,OACA,KAAA,SAAA,QAAA,KACA,MACA,IAAA,QACA,KAAA,UAAA,QAAA,KACA,MACA,IAAA,MACA,KAAA,QAAA,QAAA,IAAA,QAAA,WAtEA,QAAA,QAAA","file":"task.4b12a919.js","sourceRoot":"..\\..\\src\\site\\home","sourcesContent":["<template>\r\n  <el-form style=\"margin:10px;width:100%;\">\r\n    <el-form-item label=\"服务期限\" prop=\"buytime\">\r\n      <el-select v-model.trim=\"form.buytime\">\r\n        <el-option\r\n          :key=\"item.value\"\r\n          :value=\"item.value\"\r\n          :label=\"item.label\"\r\n          v-for=\"item in getByTimeOption()\"\r\n        ></el-option>\r\n      </el-select>\r\n      <span style=\"color:#909399;\">每月2元钱</span>\r\n    </el-form-item>\r\n    <el-form-item style=\"margin-top:50px;\">\r\n      <el-button @click=\"buy\" type=\"success\" style=\"width:90%;\">确认购买</el-button>\r\n    </el-form-item>\r\n  </el-form>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      form: {\r\n        buytime: 6\r\n      }\r\n    };\r\n  },\r\n  props: {\r\n    taskInfo: {\r\n      type: Object,\r\n      default: () => {\r\n        return {};\r\n      }\r\n    },\r\n    layerid: '',\r\n    index: {\r\n      type: Number,\r\n      default: -1\r\n    }\r\n  },\r\n  methods: {\r\n    getByTimeOption() {\r\n      const time = [];\r\n      for (let i = 1; i < 13; i++) {\r\n        time.push({\r\n          label: i + '个月',\r\n          value: i\r\n        })\r\n      }\r\n      return time;\r\n    },\r\n    async buy() {\r\n      const doc = await this.$tools.httpAgent('/buy/task', 'post', {\r\n        taskid: this.taskInfo.id,\r\n        buytime: this.form.buytime\r\n      });\r\n      if (doc.code === 200) {\r\n        this.$parent.$emit('updateData', {\r\n          index: this.index,\r\n          key: 'expire_time',\r\n          value: doc.data\r\n        });\r\n        this.$layer.close(this.layerid);\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style>\r\n</style>\r\n","<style lang=\"css\">\r\n</style>\r\n\r\n<template>\r\n  <div id=\"main\">\r\n    <base-mulmenu @search=\"page\">\r\n      <router-link :to=\"newTask()\">新建任务</router-link>\r\n      <!-- <em @click=\"del()\">删除</em> -->\r\n    </base-mulmenu>\r\n    <el-table :data=\"tableData\" border @selection-change=\"checkAll\">\r\n      >\r\n      <!-- <el-table-column type=\"selection\" width=\"55\"></el-table-column> -->\r\n      <el-table-column prop=\"name\" label=\"名称\">\r\n        <template slot-scope=\"scope\">\r\n          <i class=\"el-icon-loading\" style=\"color:green;\" v-if=\"scope.row.runstate==0\"></i>\r\n          <i class=\"el-icon-warning-outline\" v-else></i>\r\n          {{scope.row.name}}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"cron\" label=\"执行规则\" width=\"150\"></el-table-column>\r\n      <el-table-column prop=\"url\" label=\"地址\" :min-width=\"100\"></el-table-column>\r\n      <el-table-column prop=\"method\" label=\"请求方法\" width=\"80\"></el-table-column>\r\n      <el-table-column label=\"状态码\">\r\n        <template slot-scope=\"scope\">{{scope.row.lastcode}}</template>\r\n      </el-table-column>\r\n      <el-table-column label=\"最后一次错误信息\">\r\n        <template slot-scope=\"scope\">{{scope.row.lastresult}}</template>\r\n      </el-table-column>\r\n      <el-table-column label=\"执行时间\">\r\n        <template slot-scope=\"scope\">{{scope.row.lasttime | formatTime}}</template>\r\n      </el-table-column>\r\n      <el-table-column label=\"执行结束\">\r\n        <template slot-scope=\"scope\">{{scope.row.lasttimeend | formatTime}}</template>\r\n      </el-table-column>\r\n      <el-table-column label=\"有效期\">\r\n        <template slot-scope=\"scope\">{{scope.row.expire_time | formatTime}}</template>\r\n      </el-table-column>\r\n      <el-table-column label=\"操作\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button type=\"primary\" @click=\"edit(scope.row.id)\">编辑</el-button>\r\n          <el-dropdown type=\"primary\" @command=\"handleCommand\">\r\n            <el-button type=\"primary\">\r\n              更多\r\n              <i class=\"el-icon-arrow-down el-icon--right\"></i>\r\n            </el-button>\r\n            <el-dropdown-menu slot=\"dropdown\">\r\n              <el-dropdown-item\r\n                :command=\"formatCommand('stop',scope.row)\"\r\n                v-if=\"scope.row.runstate==0\"\r\n              >停止</el-dropdown-item>\r\n              <el-dropdown-item :command=\"formatCommand('start',scope.row)\" v-else>启动</el-dropdown-item>\r\n              <el-dropdown-item :command=\"formatCommand('buy',scope.row, scope.$index)\">续费</el-dropdown-item>\r\n              <el-dropdown-item :command=\"formatCommand('del',scope.row)\">删除</el-dropdown-item>\r\n            </el-dropdown-menu>\r\n          </el-dropdown>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <div style=\"margin-top:30px;text-align:right;margin-right:20px;\">\r\n      <el-pagination\r\n        background\r\n        layout=\"prev, pager, next\"\r\n        :total=\"total\"\r\n        :page-size=\"apiParams.mp\"\r\n        @current-change=\"currentChange\"\r\n        v-if=\"total>apiParams.mp\"\r\n      ></el-pagination>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport baseMixin from '../mixin/index.js';\r\nimport buyTask from './form/buyTask';\r\n\r\nexport default {\r\n  mixins: [baseMixin],\r\n  data() {\r\n    return {\r\n      model: 'task'\r\n    };\r\n  },\r\n  async mounted() {\r\n    this.$on('updateData', (data) => {\r\n      this.$set(this.tableData[data.index], data.key, data.value);\r\n    });\r\n  },\r\n  methods: {\r\n    before() {\r\n      this.apiParams.groupid = this.$route.params.groupid;\r\n    },\r\n    newTask() {\r\n      return '/usercenter/taskgroup/task/' + this.$route.params.groupid + '/edit';\r\n    },\r\n    async stopTask(row) {\r\n      const doc = await this.$tools.httpAgent('/task/stop', 'get', {\r\n        id: row.id\r\n      });\r\n      if (doc.code === 200) {\r\n        row.runstate = 1;\r\n        this.$layer.msg('停止成功');\r\n      }\r\n    },\r\n    async startTask(row) {\r\n      const doc = await this.$tools.httpAgent('/task/start', 'get', {\r\n        id: row.id\r\n      });\r\n      if (doc.code === 200) {\r\n        row.runstate = 0;\r\n        this.$layer.msg('开启成功');\r\n      }\r\n    },\r\n    buyTask(row = {}, index) {//续费\r\n      this.$layer.iframe({\r\n        title: '',\r\n        content: {\r\n          content: buyTask,\r\n          parent: this,\r\n          data: {\r\n            taskInfo: row,\r\n            index: index\r\n          }\r\n        },\r\n        area: ['500px', '250px']\r\n      });\r\n    },\r\n    formatCommand(type, row, index = -1) {\r\n      return {\r\n        type,\r\n        row,\r\n        index\r\n      }\r\n    },\r\n    handleCommand(command) {\r\n      switch (command.type) {\r\n        case 'del':\r\n          this.del(command.row);\r\n          break;\r\n        case 'stop':\r\n          this.stopTask(command.row);\r\n          break;\r\n        case 'start':\r\n          this.startTask(command.row);\r\n          break;\r\n        case 'buy':\r\n          this.buyTask(command.row, command.index);\r\n          break;\r\n      }\r\n    }\r\n  }\r\n};\r\n</script>\r\n"]}